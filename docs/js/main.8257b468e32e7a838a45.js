(self.webpackChunk=self.webpackChunk||[]).push([[179],{5828:(e,t,r)=>{"use strict";var s=r(2661),n=r(4336),i=r(8917);const o=(0,i.Uk)("Drop files here"),a={props:{modelValue:Array},methods:{files:function*(e){if(e.items)for(let t of e.items)yield t.getAsFile();else yield*e.files},drop:function(e){e.preventDefault(),this.$refs.dropzone.classList.remove("active");const t=Array.from(this.files(e.dataTransfer));this.$emit("update:modelValue",t)},dragenter:function(){this.$refs.dropzone.classList.add("active")},dragleave:function(){this.$refs.dropzone.classList.remove("active")},dragover:function(e){e.preventDefault()}}};var l=r(6959);const c=(0,l.Z)(a,[["render",function(e,t,r,s,n,a){return(0,i.wg)(),(0,i.iD)("div",{class:"drop-target",ref:"dropzone",onDrop:t[0]||(t[0]=(...t)=>e.drop&&e.drop(...t)),onDragover:t[1]||(t[1]=(...t)=>e.dragover&&e.dragover(...t)),onDragenter:t[2]||(t[2]=(...t)=>e.dragenter&&e.dragenter(...t)),onDragleave:t[3]||(t[3]=(...t)=>e.dragleave&&e.dragleave(...t))},[(0,i.WI)(e.$slots,"default",{},(()=>[o]))],544)}]]);var h=r(8319);const _={class:"lint-header"},u={class:"lint-title"},d={class:"lint-version"},m={class:"lint-subtitle"},p=(0,i.Uk)("Star"),f={class:"image-lint-app"},g={class:"pane pane-options"},w=(0,i._)("h3",{class:"lint-options-title"},"Options",-1),b={class:"lint-option lint-option-check"},x=(0,i.Uk)(" Find mismatches between file type and file extension. "),v={class:"lint-option lint-option-check"},y=(0,i.Uk)(" Find files that have been copied. "),k={class:"lint-option lint-option-number"},U=(0,i.Uk)(" Set the maximum bytes per pixel before giving a warning. "),B={class:"lint-option lint-option-number"},I=(0,i.Uk)(" Set the minimum byte savings before giving a warning. "),E={class:"lint-option lint-option-array"},z=(0,i.Uk)(" Set the allowed color spaces. "),C={class:"pane pane-dropzone"},S={key:0};var G=r(7992),D=r(343);class M extends D.EventEmitter{constructor(){super(),this._active_handlers=0,this._active_processes=0,this._done_proxy=this._done.bind(this),this._iterator=null,this.on("handler.available",this._handler_available.bind(this))}_handler_available(){if(this._iterator){const e=this._iterator.next();e.done?this._iterator=null:(this.emit("next",e.value,this._done_proxy),this._active_handlers++,this._active_processes++)}}_done(){if(this._active_handlers--,this._active_processes--,!(this._active_handlers>=0))throw new Error("No handlers available, did you call done?");this.emit("handler.available"),this._active_processes<=0&&this.emit("end")}start(e){if(this._iterator)throw new Error("Work is in progress");this._active_handlers=0,e.then((e=>{for(this._iterator=e();this._active_handlers<10;)this.emit("handler.available"),this._active_handlers++}),(e=>{e.stack?console.error(`${e.name}: ${e.message} \n`,e):console.error("Error",e)})).catch((e=>{e.stack?console.error(`${e.name}: ${e.message} \n`,e):console.error("Error",e)}))}}var R=r(2337);class Y{constructor(){this.trie=new Map}find(e){let t=this.trie,r=0;for(;r<=3;){const s=t,n=e[r];t=t.get(n),t||(t=new Map,s.set(n,t)),r++}return t}contains(e,t){const r=R.createHash("sha1");r.update(t);const s=r.digest("binary"),n=this.find(s),i=n.get(s);return i||n.set(s,e),i}}class F{constructor(e,t){this.name=e,this.channels=t,this.unk_format=null,F.all_names.add(e)}getUnkFormat(){return this.unk_format}static from(e){let t=null;return this.all_names.has(e)&&(t=F[e]),t}static unkownFormat(e,t=-1){const r=new F("UNK",t);return r.unk_format=e,r}}F.all_names=new Set,F.G=new F("G",1),F.RGB=new F("RGB",3),F.YCbCr=new F("YCbCr",3),F.YCCK=new F("YCCK",4),F.LAB=new F("LAB",3),F.HSV=new F("HSV",3),F.CMYK=new F("CMYK",4),F.XYZ=new F("XYZ",3),F.XYB=new F("XYB",3);class N{constructor(){this.indexed=!1,this.alpha=!1,this.bit_depth={}}}var L=r(5479);class V{constructor(e){this.filename=e,this.log="",this.count={info:0,warn:0,error:0}}is_printable(){return this.count.warn>0||this.count.error>0}info(e){this.count.info++,this.log+="\n  INFO:  "+e}warn(e){this.count.warn++,this.log+="\n  "+L.yellow("WARN:")+"  "+e}error(e){this.count.error++,this.log+="\n  "+L.red("ERROR:")+"  "+e}get_error_count(){return this.count.error}get_warning_count(){return this.count.warn}toString(){let e=this.count.warn.toString(),t=this.count.error.toString();return this.count.warn&&(e=L.yellow(e)),this.count.error&&(t=L.red(t)),this.filename+this.log+"\n"+e+" warnings. "+t+" errors."}}class ${constructor(){this._info_provider=null}identify_only(){return!this.get_info_provider()}is_of_file_type(e){throw new Error("Not Implemented")}get_extension(){return this.get_extensions()[0]}get_extensions(){throw new Error("Not Implemented")}get_mime(){return this.get_mimes()[0]}get_mimes(){throw new Error("Not Implemented")}can_validate(e){return!1}get_info_provider(){return null}static register(e){const t=new e,r=t.identify_only();for(const e of t.get_extensions())this._extension_registry.set(e,t),r||this._all_extensions.push(e);for(const e of t.get_mimes())this._mime_registry.set(e,t),r||this._all_mimes.push(e);this._all_providers.push(t)}static clear_registry(){this._extension_registry.clear(),this._all_extensions.length=0,this._mime_registry.clear(),this._all_mimes.length=0,this._all_providers.length=0}static get_all_extensions(){return $._all_extensions}static get_all_mimes(){return $._all_mimes}static from_extension(e){return $._extension_registry.get(e)}static*all_providers(){yield*$._all_providers}}$._extension_registry=new Map,$._mime_registry=new Map,$._all_providers=[],$._all_extensions=[],$._all_mimes=[];var T=r(816).Buffer;class q extends ${get_magic(){throw new Error("Not Implemented")}is_of_file_type(e){const t=this.get_magic(),r=e.slice(0,t.length);return 0===T.compare(t,r)}can_validate(e){const t=this.get_magic();return e.length>=t.length}}var A=r(1461);class j{calculate_bpp(e,t){return(t-this.get_overhead())/(e.width*e.height*e.frames)}get_overhead(){return 0}get_dimensions(e){throw new Error("Not Implemented")}get_pixel_format(e){throw new Error("Not Implemented")}get_info(e){const t={truncated:this.is_truncated(e)};if(!t.truncated){const r=this.get_dimensions(e);t.dimensions=r,t.size=e.length,t.pixel_format=this.get_pixel_format(e),t.bytes_per_pixel=this.calculate_bpp(r,e.length)}return t}is_truncated(e){throw new Error("Not Implemented")}}var K=r(816).Buffer;const O=new Set([0,4]),P=new Set([2,3,6]),W=new Set([4,6]),Z=new Set([4]);class H{constructor(e,t){this.length=e.readUInt32BE(t),this.header=e.readUInt32BE(t+4),this.data=e.slice(t+4+4,this.length),this.crc32=e.readUInt32BE(t+4+4+this.length)}verify(){const e=K.alloc(4);let t=null;return e.writeUInt32BE(this.header,0),t=A.ZP.crc32(e),t=A.ZP.crc32(this.data,t),t===this.crc32}}class X extends j{get_overhead(){return 67}is_truncated(e){let t=null;try{t=new H(e,e.length-12)}catch(e){return!0}return 1229278788===t.header&&!t.verify()}get_dimensions(e){return{width:e.readUInt32BE(16),height:e.readUInt32BE(20),frames:1}}get_pixel_format(e){const t=new N,r=e.readInt8(24),s=e.readInt8(25);return P.has(s)?(t.color_space=F.RGB,t.bit_depth.R=r,t.bit_depth.G=r,t.bit_depth.B=r):O.has(s)?(t.color_space=F.G,t.bit_depth.G=r):t.color_space=F.unkownFormat(s),W.has(s)&&(t.alpha=!0,t.bit_depth.alpha=r),Z.has(s)&&(t.indexed=!0),t}}var J=r(816).Buffer;$.register(class extends q{get_magic(){return J.from("89504e470d0a1a0a","hex")}get_extensions(){return[".png"]}get_mimes(){return["image/png"]}get_info_provider(){return X}});class Q extends j{get_overhead(){return 35}next_chunk(e,t){const r=2+e.readUInt8(t+2);return t+r+this.get_sub_block_length(e,t+r+1)+1}get_sub_block_length(e,t){let r=0,s=e.readUInt8(t);if(0!==s)for(;0!==s;)s=e.readUInt8(t+r),r+=s+1;else r=1;return r}get_color_table_length(e,t){const r=7&e.readUInt8(t);return 3*Math.pow(2,r+1)}has_color_table(e,t){return!!(128&e.readUInt8(t))}get_version(e){return e.toString("ascii",3,6)}get_dimensions(e){let t=0,r=!1,s=0;for(s=this.has_color_table(e,10)?13+this.get_color_table_length(e,10):13;!r;){let n=e.readUInt8(s);44===n&&(t++,s+=9,this.has_color_table(e,s)&&(s+=this.get_color_table_length(e,s)),s+=2,s+=this.get_sub_block_length(e,s)),s+1>=e.length?r=!0:(n=e.readUInt8(s),33===n||44===n?s=this.next_chunk(e,s):r=!0)}return{width:e.readUInt16LE(6),height:e.readUInt16LE(8),frames:t}}is_truncated(e){return 59!==e.readUInt8(e.length-1)}get_pixel_format(){const e=new N;return e.color_space=F.RGB,e.indexed=!0,e.bit_depth.R=8,e.bit_depth.G=8,e.bit_depth.B=8,e.bit_depth.alpha=1,e}}var ee=r(816).Buffer;$.register(class extends q{get_magic(){return ee.from("GIF")}get_extensions(){return[".gif"]}get_mimes(){return["image/gif"]}get_info_provider(){return Q}});class te extends j{next_chunk(e,t){return t+2+e.readUInt16BE(t+2)}is_sof_chunk(e,t){const r=e.readUInt8(t+1);return 192==(240&r)&&196!==r&&200!==r&&204!==r}*chunks(e){let t=this.next_chunk(e,2),r=!1;for(;!r;)yield t,t=this.next_chunk(e,t),t>e.length&&(r=!0)}get_overhead(){return 119}is_truncated(e){return 65497!==e.readUInt16BE(e.length-2)}get_dimensions(e){let t=null,r=null;for(const s of this.chunks(e))if(this.is_sof_chunk(e,s)){t=e.readUInt16BE(s+7),r=e.readUInt16BE(s+5);break}if(!t||!r)throw new Error("Dimensions not found");return{width:t,height:r,frames:1}}get_pixel_format(e){const t=new N;let r=null;for(const t of this.chunks(e))if(this.is_sof_chunk(e,t)){r=e.readUInt8(t+9);break}return t.color_space=1===r?F.G:3===r?F.RGB:4===r?F.CMYK:F.unkownFormat("Unknown",r),t}}var re=r(816).Buffer;$.register(class extends q{get_magic(){return re.from("ffd8ff","hex")}get_extensions(){return[".jpg",".jpeg",".jpe"]}get_mimes(){return["image/jpeg"]}get_info_provider(){return te}});const se=4294967295;class ne extends Error{}class ie{constructor(e,t=0){this.buffer=e,this.offset=t,this.sub_bit=0,this.current_byte=e.readUInt8(t)}read_from_byte(e,t,r){let s=e,n=(1<<r)-1;return n=n<<t>>>0,s=(s&n)>>>t,s}read_bits(e){if(e>32)throw new Error(`Can not read more than 32 bits at a time. Attempting to read ${e}`);if(0===e)return 0;let t=0,r=0;const s=8-this.sub_bit;this.sub_bit>0&&e>s&&(e-=s,t=this.read_from_byte(this.current_byte,this.sub_bit,s),r=s,this.offset+=1,this.current_byte=this.buffer.readUInt8(this.offset),this.sub_bit=0);const n=Math.floor(e/8);let i=t;if(n>0){for(let e=0;e<n;e++){let e=this.read_from_byte(this.current_byte,0,8);r&&(e<<=r),this.offset+=1,this.current_byte=this.buffer.readUInt8(this.offset),r+=8,i|=e}this.sub_bit=0}if((e-=8*n)>0){let t=this.read_from_byte(this.current_byte,this.sub_bit,e);r&&(t<<=r),i|=t,this.sub_bit+=e}return i}read_boolean(){return!!this.read_bits(1)}read_u32(...e){if(e.length>4)throw new Error("U32: A u32 takes only 4 distributions.");const t=e[this.read_bits(2)];if(0===t[0])return t[1];if(1===t[0])return this.read_bits(t[1]);if(2===t[0]){if(3!==t.length)throw new Error("U32: incorrect number of parameters for BitsOffset distribution.");return(t[2]+this.read_bits(t[1]))%se}throw new Error("U32: Unknown distribution.")}read_s32(...e){const t=this.read_u32(...e);return t%2==0?t>>1:t===se?2147483648:-(t>>1)}read_f16(){const e=this.read_bits(16),t=e>>15,r=e>>10&31,s=1023&e;let n;if(31===r)throw new ne("F16: Invalid biased exponent.");if(0==r)n=s/(1<<24);else{const e=r+112,i=s<<13,o=new ArrayBuffer(4);new Uint32Array(o)[0]=t<<31|e<<23|i,n=new Float32Array(o)[0]}return n}read_customxy(){return{x:this.read_s32([1,19],[2,19,524288],[2,20,1048576],[2,21,2097152]),y:this.read_s32([1,19],[2,19,524288],[2,20,1048576],[2,21,2097152])}}read_enum(e){const t=this.read_u32([0,0],[0,1],[2,4,2],[2,6,18]);if(t>63)throw new ne(`Enum: Invalid value: ${t}`);if(!e.has(t))throw new ne(`Enum: Unknown value: ${t}`);return t}get_bits_read(){return 8*this.offset+this.sub_bit}}class oe{constructor(e){let t,r;if(this.small=e.read_boolean(),t=this.small?8*(e.read_bits(5)+1):e.read_u32([1,9],[1,13],[1,18],[1,30])+1,this.ratio=e.read_bits(3),0===this.ratio)r=this.small?8*(e.read_bits(5)+1):e.read_u32([1,9],[1,13],[1,18],[1,30])+1;else if(1===this.ratio)r=t;else if(2===this.ratio)r=Math.floor(12*t/10);else if(3===this.ratio)r=Math.floor(4*t/3);else if(4===this.ratio)r=Math.floor(3*t/2);else if(5===this.ratio)r=Math.floor(16*t/9);else if(6===this.ratio)r=Math.floor(5*t/4);else{if(7!==this.ratio)throw new Error("SizeHeader: unknown aspect ratio.");r=Math.floor(2*t/1)}this.ysize=t,this.xsize=r}get_small(){return this.small}get_ysize(){return this.ysize}get_xsize(){return this.xsize}get_ratio(){return this.ratio}}const ae=new Set;ae.add(0),ae.add(1),ae.add(2),ae.add(3),ae.add(4);const le=new Set;le.add(1),le.add(2),le.add(10),le.add(11);const ce=new Set;ce.add(1),ce.add(2),ce.add(9),ce.add(11);const he=new Set;he.add(1),he.add(2),he.add(8),he.add(13),he.add(16),he.add(17),he.add(18);const _e=new Set;_e.add(0),_e.add(1),_e.add(2),_e.add(3);class ue{constructor(e){if(this.received_icc=!1,this.opaque_icc=!1,this.color_space=0,this.white_point=1,this.primaries=1,this.have_gamma=!1,this.gamma=0,this.transfer_function=13,this.rendering_intent=1,e){const t=e.read_boolean();t||(this.received_icc=e.read_boolean(),this.received_icc?this.opaque_icc=e.read_boolean():this.opaque_icc=!1,t||this.opaque_icc||(this.color_space=e.read_enum(ae),2!==this.color_space&&4!==this.color_space&&(this.white_point=e.read_enum(le),2===this.white_point&&(this.white=e.read_customxy()),1!==this.color_space&&(this.primaries=e.read_enum(ce),2===this.primaries&&(this.red=e.read_customxy(),this.green=e.read_customxy(),this.blue=e.read_customxy())),this.have_gamma=e.read_boolean(),this.have_gamma?this.gamma=e.read_bits(24):this.transfer_function=e.read_enum(he),1!==this.color_space&&(this.rendering_intent=e.read_enum(_e)))))}}}class de{constructor(e){e.read_boolean()?(this.have_icc=!1,this.bits_per_sample=8,this.color_encoding=new ue,this.alpha_bits=0,this.target_nits=250,this.m2=null):(this.have_icc=e.read_boolean(),this.bits_per_sample=e.read_u32([0,8],[0,16],[0,32],[1,5]),this.color_encoding=new ue(e),this.alpha_bits=e.read_u32([0,0],[0,8],[0,16],[1,4]),this.target_nits=e.read_u32([0,5],[0,20],[0,80],[2,10,1]),this.m2=null)}}class me extends j{get_overhead(){return 119}is_truncated(e){return 0!==e.readUInt8(e.length-1)}get_dimensions(e){const t=new ie(e,0),r=new oe(t);return{width:r.get_xsize(),height:r.get_ysize(),frames:1}}get_pixel_format(e){const t=new ie(e,0),r=new de(t).color_encoding,s=new N;return r&&(1===r.color_space?s.color_space=F.G:0===r.color_space?s.color_space=F.RGB:4===r.color_space?s.color_space=F.XYZ:2===r.color_space?s.color_space=F.XYB:s.color_space=F.unkownFormat(r)),s}}var pe=r(816).Buffer;$.register(class extends q{get_magic(){return pe.from("ff0a","hex")}get_extensions(){return[".jxl"]}get_mimes(){return["image/jxl"]}get_info_provider(){return me}});class fe{constructor(e,t){this.length=e,this.tag=t}static read(e,t){let r;const s=e.readUInt32BE(t);if(s){const n=e.toString("ascii",t+4,t+8),i=e.subarray(t+8,t+s);r=n in ve?new ve[n](s,n,i):new we(s,n,i)}else r=new be;return r}}class ge extends fe{constructor(e,t,r,s=0){super(e,t),this._buffer=r,this._offset=s,this._children=null}get children(){const e=this._buffer,t=this._offset;if(!this._children){this._children={};for(const r of this.readBlocks(e,t))null===r.tag||this._children[r.tag]||(this._children[r.tag]=r)}return this._children}*readBlocks(e,t){let r=0,s=2048;for(;r+t<e.length&&s;){const n=fe.read(e,t+r);r+=n.length,s--,yield n}}}class we extends fe{constructor(e,t,r){super(e,t),this.content=r}}class be extends fe{constructor(){super(4,null)}}class xe extends ge{constructor(e){super(e.length,null,e)}}const ve={ftyp:class extends fe{constructor(e,t,r){super(e,t),this.majorBrand=this.readBrand(0,r),this.minorVersion=r.readUInt32BE(4),this.compatibleBrands=[];const s=(e-16)/4;for(let e=0;e<s;e++)this.compatibleBrands.push(this.readBrand(4*e+8,r))}readBrand(e,t){return t.subarray(e,e+4).toString("ascii")}},meta:ge,iprp:ge,iinf:class extends ge{constructor(e,t,r){super(e,t,r,6)}},ipco:ge,ispe:class extends fe{constructor(e,t,r){super(e,t),this.unknown=r.readUInt32BE(0),this.width=r.readUInt32BE(4),this.height=r.readUInt32BE(8)}},pixi:class extends fe{constructor(e,t,r){super(e,t,r),this.unknown=r.readUInt32BE(0),this.channels=r.readUInt8(4),this.bitsPerChannel=[];for(let e=0;e<this.channels;e++)this.bitsPerChannel.push(r.readUInt8(5))}}};class ye extends j{get_overhead(){return 333}is_truncated(e){return!1}get_dimensions(e){const t=new xe(e).children.meta.children.iprp.children.ipco.children.ispe;return{width:t.width,height:t.height,frames:1}}get_pixel_format(e){const t=new xe(e),r=new N;r.color_space=F.RGB;const s=t.children.meta.children.iprp.children.ipco.children.pixi;if(s){const e=s.channels;r.color_space=1===e?F.G:3===e?F.RGB:F.unkownFormat("Unknown",e)}else r.color_space=F.RGB;return r}}$.register(class extends ${can_validate(e){return e.length>12}is_of_file_type(e){const t=e.subarray(4,12).toString("ascii");return"ftypavif"===t||"ftypheic"===t}get_extensions(){return[".avif",".heif",".heic"]}get_mimes(){return["image/avif","image/heif","image/heic"]}get_info_provider(){return ye}});var ke=r(816).Buffer;$.register(class extends q{get_magic(){return ke.from("424D","hex")}get_extensions(){return[".bmp"]}get_mimes(){return["image/bmp","image/x-bmp"]}});var Ue=r(816).Buffer;$.register(class extends q{get_magic(){return Ue.from("38425053","hex")}get_extensions(){return[".psd"]}get_mimes(){return["image/photoshop","image/x-photoshop","image/psd"]}}),$.register(class extends ${can_validate(e){return e.length>4}is_of_file_type(e){const t=e.readUInt16LE(0),r=e.readUInt16LE(2);return 0===t&&(1===r||2===r)}get_extensions(){return[".ico",".cur"]}get_mimes(){return["image/x-icon"]}});var Be=r(816).Buffer;$.register(class extends q{get_magic(){return Be.from([73,73,42,0])}get_extensions(){return[".tif",".tiff"]}get_mimes(){return["image/tiff","image/tiff-fx"]}});class Ie extends ${get_type_tag(){throw new Error("Not Implemented!")}can_validate(e){return e.length>12}is_of_file_type(e){const t=e.readUInt32BE(0),r=e.readUInt32BE(8);return 1380533830===t&&r===this.get_type_tag()}}$.register(class extends Ie{get_type_tag(){return 1464156752}get_extensions(){return[".webp"]}get_mimes(){return["image/webp"]}});class Ee extends ${get_root_element(){throw new Error("Not Implemented!")}is_of_file_type(e){return e.slice(0,512).toString().toLowerCase().includes("<"+this.get_root_element())}can_validate(e){return!0}}$.register(class extends Ee{get_root_element(){return"svg"}get_extensions(){return[".svg"]}get_mimes(){return["image/svg+xml"]}}),$.register(class extends Ee{get_root_element(){return"html"}get_extensions(){return[".html",".htm",".xhtml"]}get_mimes(){return["text/html","application/xhtml+xml"]}});var ze=r(816).Buffer;class Ce extends D.EventEmitter{constructor(e){super(),this.finder=e,this.disable_color=!1}calculate_optimial_size(e,t){return e.width*e.height*e.frames*t}describe_file(e){return"File properties: "+e.width+"x"+e.height+(1!==e.frames?", "+e.frames+" frames":"")}get_info(e,t,r,s){return new Promise(((n,i)=>{const o=e.extension.toLowerCase();let a=$.from_extension(o),l=null,c=!1;if(t instanceof ze){if(l=t,a?c=a.is_of_file_type(l):r.warn('There is no information provider for "'+o+'" files.'),!a||!c){!0===s.mismatch?r.info("This file is not what it seems, attempting brute force discovery of file type."):r.info("This file is not what it seems."),a=null;for(const e of $.all_providers())e.can_validate(l)&&e.is_of_file_type(l)&&(a=e)}if(!c){let e="unknown";a&&(e=a.get_extension()),!0===s.mismatch&&r.warn("There is a mismatch between the file extension ("+o+") and the file contents ("+e+")")}if(a){const e=a.get_info_provider();e?n((new e).get_info(l)):i("Unsupported file type")}else i("Unknown file type")}else i("Image buffer is missing, this is a bug.")}))}lint(e,t){const r=this,s=new M,n=new Y;let i=null;if(t.color_space){const e=t.color_space;i=new Set;for(let t of e)t=F.from(t),t&&i.add(t)}return s.on("next",((e,s)=>{const o=class{static get_log(e){return new V(e)}}.get_log(e.path);function a(e){e.stack?o.error(e.message+": "+e.stack):o.error(e),r.emit("file.completed",o),s()}e.loader.load().then((r=>{if(0===r.length)throw"This is an empty file, further analysis is not possible.";if(!0===t.duplicate){const t=n.contains(e.path,r);t&&o.warn("This file is a duplicate of: "+t)}return this.get_info(e,r,o,t)})).then((e=>{if(e.truncated)o.error("This image is truncated, further analysis is not possible.");else{const r=e.pixel_format.color_space,s=t.bytes_per_pixel,n=t.byte_savings,a=e.size-this.calculate_optimial_size(e.dimensions,s);if(o.info(this.describe_file(e.dimensions)),e.bytes_per_pixel>=s&&a>n&&(o.warn("The bytes per pixel ("+e.bytes_per_pixel.toFixed(2)+") exceeds the minimum ("+s+")."),o.info("You can acheive a minimum savings of "+a+" bytes by meeting this threshold.")),i)if("UNK"===r.name){const e=r.channels>0?r.channels:"an unknown number of";o.error(`This image has an unknown color space ${r.getUnkFormat()} with ${e} channels.`)}else i.size&&!i.has(r)&&o.warn(`The color space of this image is ${r.name}. It must be one of ${t.color_space}.`)}this.emit("file.completed",o),s()}),a).catch(a)})),s.on("end",(()=>{this.emit("linter.completed")})),s.start(this.finder.get_files(e)),this}}const Se={bytes_per_pixel:3,byte_savings:500,color_space:"G,RGB",mismatch:!0,duplicate:!0};var Ge=r(816).Buffer;class De extends class{constructor(e){this._path=e}getPath(){return this._path}load(){return Promise.reject("Not Implemented!")}}{constructor(e){super(""),this._blob=e}async load(){const e=await this._blob.arrayBuffer();return Ge.from(e)}}var Me=r(7425);const Re=JSON.parse('{"u2":"image-lint","i8":"3.0.0","WL":"Find files that are incorrectly named or compressed."}'),Ye={components:{GithubButton:G.Z},data(){const e=Object.assign({},Se);return e.color_space=e.color_space.split(","),{name:Re.u2,version:Re.i8,description:Re.WL,support:{},available:{color_space:["G","RGB","CMYK","YCbCr","YCCK","LAB","HSV"]},option:e,files:[]}},methods:{clear:function(){this.files.length=0}}},Fe=(0,l.Z)(Ye,[["render",function(e,t,r,n,o,a){const l=(0,i.up)("github-button"),c=(0,i.up)("vue-multiselect"),G=(0,i.up)("image-collection"),D=(0,i.up)("dropzone");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i._)("header",_,[(0,i._)("h1",u,(0,h.zw)(o.name),1),(0,i._)("span",d,"v"+(0,h.zw)(o.version),1),(0,i._)("h2",m,(0,h.zw)(o.description),1),(0,i.Wm)(l,{class:"github-button",href:"https://github.com/aaronasachimp/image-lint","data-size":"large","data-show-count":"true","aria-label":"Star aaronasachimp/image-lint on GitHub"},{default:(0,i.w5)((()=>[p])),_:1})]),(0,i._)("form",f,[(0,i._)("div",g,[w,(0,i._)("label",b,[(0,i.wy)((0,i._)("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=e=>o.option.mismatch=e)},null,512),[[s.e8,o.option.mismatch]]),x]),(0,i._)("label",v,[(0,i.wy)((0,i._)("input",{type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=e=>o.option.duplicate=e)},null,512),[[s.e8,o.option.duplicate]]),y]),(0,i._)("label",k,[U,(0,i.wy)((0,i._)("input",{type:"number","onUpdate:modelValue":t[2]||(t[2]=e=>o.option.bytes_per_pixel=e),step:"0.1",min:"0"},null,512),[[s.nr,o.option.bytes_per_pixel]])]),(0,i._)("label",B,[I,(0,i.wy)((0,i._)("input",{type:"number","onUpdate:modelValue":t[3]||(t[3]=e=>o.option.byte_savings=e),min:"0"},null,512),[[s.nr,o.option.byte_savings]])]),(0,i._)("label",E,[z,(0,i.Wm)(c,{modelValue:o.option.color_space,"onUpdate:modelValue":t[4]||(t[4]=e=>o.option.color_space=e),multiple:!0,options:o.available.color_space},null,8,["modelValue","options"])])]),(0,i._)("div",C,[(0,i.Wm)(D,{modelValue:o.files,"onUpdate:modelValue":t[6]||(t[6]=e=>o.files=e),class:(0,h.C_)({empty:0==o.files.length})},{default:(0,i.w5)((()=>[o.files.length?((0,i.wg)(),(0,i.iD)("div",S,[(0,i._)("button",{type:"button",onClick:t[5]||(t[5]=(...t)=>e.clear&&e.clear(...t))},"Clear Results"),(0,i.Wm)(G,{options:o.option,files:o.files},null,8,["options","files"])])):(0,i.kq)("",!0)])),_:1},8,["modelValue","class"])])])])}]]),Ne={class:"lint-results"},Le={open:""},Ve={key:0},$e=(0,i.Uk)(" - "),Te={key:0},qe={key:0},Ae={key:1},je={key:0},Ke={key:2},Oe=["innerHTML"],Pe=new class extends class{constructor(e,t){this.extensions=e,this.mimes=t}get_files(e){throw new Error("Not Implemented")}is_image_extension(e){return this.extensions.indexOf(e)>=0}is_image_mime(e){return this.mimes.indexOf(e)>=0}}{get_files(e){return Promise.resolve(this._search.bind(this,e))}*_search(e){for(const t of e){const e=Me.extname(t.name);yield{path:t.name,extension:e,loader:new De(t)}}}}($.get_all_extensions(),$.get_all_mimes()),We={props:["options","files"],data:()=>({linter:null,error:null,results:null}),watch:{files:{async handler(e,t){let r=this.options,s=null,n=new Ce(Pe);try{s=await new Promise(((t,s)=>{let i=[];n.lint(e,r).on("file.completed",(e=>{i.push(e)})).on("linter.completed",(()=>{t(i)}))}))}catch(e){return void(this.error=e)}this.results=s},immediate:!0}},computed:{has_finished(){return null!==this.results||null!==this.error},has_error(){return null!==this.error},has_results(){return null!==this.results}},methods:{reformat_log:e=>e.trim().split("\n").map((e=>e.trim())).join("\n")}},Ze=(0,l.Z)(We,[["render",function(e,t,r,s,n,o){return(0,i.wg)(),(0,i.iD)("ul",Ne,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.results,(t=>((0,i.wg)(),(0,i.iD)("li",{class:(0,h.C_)(["lint-result",{"has-error":e.has_error,"has-results":e.has_results}])},[(0,i._)("details",Le,[(0,i._)("summary",{class:(0,h.C_)(["lint-result-summary",{"lint-error":t&&t.count.error,"lint-warn":t&&t.count.warn}])},[(0,i.Uk)((0,h.zw)(t.filename)+" ",1),e.has_results?((0,i.wg)(),(0,i.iD)("span",Ve,[$e,t.count.info?((0,i.wg)(),(0,i.iD)("span",Te,[(0,i.Uk)("Info: "+(0,h.zw)(t.count.info),1),t.count.warn||t.count.error?((0,i.wg)(),(0,i.iD)("span",qe,", ")):(0,i.kq)("",!0)])):(0,i.kq)("",!0),t.count.warn?((0,i.wg)(),(0,i.iD)("span",Ae,[(0,i.Uk)("Warnings: "+(0,h.zw)(t.count.warn),1),t.count.error?((0,i.wg)(),(0,i.iD)("span",je,", ")):(0,i.kq)("",!0)])):(0,i.kq)("",!0),t.count.error?((0,i.wg)(),(0,i.iD)("span",Ke,"Errors: "+(0,h.zw)(t.count.error),1)):(0,i.kq)("",!0)])):(0,i.kq)("",!0)],2),e.has_results?((0,i.wg)(),(0,i.iD)("output",{key:0,class:"lint-result-output",innerHTML:e.reformat_log(t.log)},null,8,Oe)):(0,i.kq)("",!0)])],2)))),256))])}]]),He=document.body,Xe=document.createElement("div");He.appendChild(Xe),(0,s.ri)(Fe).component("vue-multiselect",n.ZP).component("dropzone",c).component("image-lint-app",Fe).component("image-collection",Ze).mount(Xe)},2909:()=>{},5545:()=>{},6047:()=>{},6611:()=>{},1212:()=>{},303:()=>{},7523:()=>{},4282:()=>{},471:()=>{},1632:()=>{}},e=>{e.O(0,[216],(()=>(5828,e(e.s=5828)))),e.O()}]);
//# sourceMappingURL=main.8257b468e32e7a838a45.js.map