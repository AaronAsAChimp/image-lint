(self.webpackChunkimage_lint_web=self.webpackChunkimage_lint_web||[]).push([[179],{2909:()=>{},5545:()=>{},6047:()=>{},6611:()=>{},1212:()=>{},303:()=>{},7523:()=>{},4282:()=>{},471:()=>{},1632:()=>{},4987:(e,t,s)=>{"use strict";var r=s(2661),n=s(4336),i=s(7332),o=s(8917),a=s(8319);const l={class:"lint-header"},c={class:"lint-title"},h={class:"lint-version"},d={class:"lint-nav"};var u=s(7992);const _=JSON.parse('{"u2":"image-lint","i8":"3.1.0","WL":"Find files that are incorrectly named or compressed."}'),g={components:{GithubButton:u.Z},data:()=>({name:_.u2,version:_.i8,description:_.WL})};var m=s(6959);const f=(0,m.Z)(g,[["render",function(e,t,s,r,n,i){const u=(0,o.up)("router-link"),_=(0,o.up)("github-button"),g=(0,o.up)("router-view");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("header",l,[(0,o._)("h1",c,(0,a.zw)(n.name),1),(0,o._)("span",h,"v"+(0,a.zw)(n.version),1),(0,o._)("nav",d,[(0,o.Wm)(u,{to:"/"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Home ")])),_:1}),(0,o.Wm)(u,{to:"/getting-started"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Getting Started ")])),_:1}),(0,o.Wm)(u,{to:"/docs"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Docs ")])),_:1})]),(0,o.Wm)(_,{class:"github-button",href:"https://github.com/aaronasachimp/image-lint","data-size":"large","data-show-count":"true","aria-label":"Star aaronasachimp/image-lint on GitHub"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Star ")])),_:1})]),(0,o.Wm)(g)])}]]),p={class:"image-lint-app"},w={class:"pane pane-options"},b=(0,o._)("h3",{class:"lint-options-title"}," Options ",-1),x={class:"lint-option lint-option-check"},v={class:"lint-option lint-option-check"},y={class:"lint-option lint-option-number"},k={class:"lint-option lint-option-number"},U={class:"lint-option lint-option-array"},I={class:"pane pane-dropzone"},E={key:0};var B=s(343);class S extends B.EventEmitter{constructor(){super(),this._active_handlers=0,this._active_processes=0,this._done_proxy=this._done.bind(this),this._iterator=null,this._stopped=!1,this.on("handler.available",this._handler_available.bind(this))}_handler_available(){if(this._iterator){const e=this._iterator.next();e.done?this._iterator=null:(this.emit("next",e.value,this._done_proxy),this._active_handlers++,this._active_processes++)}}_done(){if(this._active_handlers--,this._active_processes--,!this._stopped){if(!(this._active_handlers>=0)||this._stopped)throw new Error("No handlers available, did you call done?");this.emit("handler.available")}this._active_processes<=0&&this.emit("end")}is_stopped(){return this._stopped}start(e){if(this._iterator)throw new Error("Work is in progress");this._active_handlers=0,e.then((e=>{for(this._iterator=e();this._active_handlers<10;)this.emit("handler.available"),this._active_handlers++}),(e=>{e.stack?console.error(`${e.name}: ${e.message} \n`,e):console.error("Error",e)})).catch((e=>{e.stack?console.error(`${e.name}: ${e.message} \n`,e):console.error("Error",e)}))}stop(){this._stopped=!0}}var F=s(2337);class D{constructor(){this.trie=new Map}find(e){let t=this.trie,s=0;for(;s<=3;){const r=t,n=e[s];t=t.get(n),t||(t=new Map,r.set(n,t)),s++}return t}contains(e,t){const s=F.createHash("sha1");s.update(t);const r=s.digest("binary"),n=this.find(r),i=n.get(r);return i||n.set(r,e),i}}class ${constructor(e,t){this.name=e,this.channels=t,this.unk_format=null,$.all_names.add(e)}getUnkFormat(){return this.unk_format}static from(e){let t=null;return this.all_names.has(e)&&(t=$[e]),t}static unkownFormat(e,t=-1){const s=new $("UNK",t);return s.unk_format=e,s}}$.all_names=new Set,$.G=new $("G",1),$.RGB=new $("RGB",3),$.YCbCr=new $("YCbCr",3),$.YCCK=new $("YCCK",4),$.LAB=new $("LAB",3),$.HSV=new $("HSV",3),$.CMYK=new $("CMYK",4),$.XYZ=new $("XYZ",3),$.XYB=new $("XYB",3);class R{constructor(){this.indexed=!1,this.alpha=!1,this.bit_depth={}}}var z=s(5479);class C{constructor(e=null,t=null){this.filename=e,this.parent=t,this.log="",this._muted=!1,this.count={info:0,warn:0,error:0}}_increment_count(e){this.count[e]++,this.parent&&this.parent._increment_count(e)}is_printable(){return this.count.warn>0||this.count.error>0}mute(){this._muted=!0}info(e){this._increment_count("info"),this.log+="\n  INFO:  "+e}warn(e){this._increment_count("warn"),this.log+="\n  "+z.yellow("WARN:")+"  "+e}error(e){this._increment_count("error"),this.log+="\n  "+z.red("ERROR:")+"  "+e}get_error_count(){return this.count.error}get_warning_count(){return this.count.warn}get_logger(e){return new C(e,this)}toString(){let e=this.count.warn.toString(),t=this.count.error.toString();return this.count.warn&&(e=z.yellow(e)),this.count.error&&(t=z.red(t)),this.filename+this.log+"\n"+e+" warnings. "+t+" errors."}}const N=new C;class G{constructor(){this._info_provider=null}identify_only(){return!this.get_info_provider()}is_of_file_type(e){throw new Error("Not Implemented")}get_extension(){return this.get_extensions()[0]}get_extensions(){throw new Error("Not Implemented")}get_mime(){return this.get_mimes()[0]}get_mimes(){throw new Error("Not Implemented")}can_validate(e){return!1}get_info_provider(){return null}debug_print(e,t){t.write("There is no debugging information available.\n")}get_linter(e){return null}}var O=s(816).Buffer;class T extends G{get_magic(){throw new Error("Not Implemented")}is_of_file_type(e){const t=this.get_magic(),s=e.slice(0,t.length);return 0===O.compare(t,s)}can_validate(e){const t=this.get_magic();return e.length>=t.length}}class L{calculate_bpp(e,t){return(t-this.get_overhead())/(e.width*e.height*e.frames)}get_overhead(){return 0}get_dimensions(e){throw new Error("Not Implemented")}get_pixel_format(e){throw new Error("Not Implemented")}get_info(e){const t={truncated:this.is_truncated(e)};if(!t.truncated){const s=this.get_dimensions(e);t.dimensions=s,t.size=e.length,t.pixel_format=this.get_pixel_format(e),t.bytes_per_pixel=this.calculate_bpp(s,e.length)}return t}is_truncated(e){throw new Error("Not Implemented")}}var M=s(1461),P=s(816).Buffer;const V=1229278788;class q{constructor(e,t){this.offset=t,this.length=e.readUInt32BE(t),this.header=e.readUInt32BE(t+4),this.data=e.slice(t+4+4,this.length),this.crc32=e.readUInt32BE(t+4+4+this.length)}verify(){const e=P.alloc(4);let t=null;return e.writeUInt32BE(this.header,0),t=M.ZP.crc32(e),t=M.ZP.crc32(this.data,t),t===this.crc32}get_total_length(){return 8+this.length+4}describe(){return`${P.from(this.header.toString(16),"hex")} (offset ${this.offset}, length ${this.length})`}static get_chunks(e,t){let s=t,r=!1;const n=[];for(;s<e.length&&!r;){const t=new q(e,s);n.push(t),s+=t.get_total_length(),r=t.header===V}return n}}const A=new Set([0,4]),Y=new Set([2,3,6]),W=new Set([4,6]),j=new Set([4]);class H extends L{get_overhead(){return 67}is_truncated(e){let t=null;try{t=new q(e,e.length-12)}catch(e){return!0}return t.header===V&&!t.verify()}get_dimensions(e){return{width:e.readUInt32BE(16),height:e.readUInt32BE(20),frames:1}}get_pixel_format(e){const t=new R,s=e.readInt8(24),r=e.readInt8(25);return Y.has(r)?(t.color_space=$.RGB,t.bit_depth.R=s,t.bit_depth.G=s,t.bit_depth.B=s):A.has(r)?(t.color_space=$.G,t.bit_depth.G=s):t.color_space=$.unkownFormat(r),W.has(r)&&(t.alpha=!0,t.bit_depth.alpha=s),j.has(r)&&(t.indexed=!0),t}}class Z{lint(e){throw new Error("Not Implemented!")}}class K extends Z{constructor(e){super(),this.buffer=e}lint(e){const t=q.get_chunks(this.buffer,8),s=t[t.length-1];s.offset+s.get_total_length()<this.buffer.length&&e.error("This file contains extra data at the end of the file.")}}var X=s(816).Buffer;class J extends L{get_overhead(){return 35}next_chunk(e,t){const s=2+e.readUInt8(t+2);return t+s+this.get_sub_block_length(e,t+s+1)+1}get_sub_block_length(e,t){let s=0,r=e.readUInt8(t);if(0!==r)for(;0!==r;)r=e.readUInt8(t+s),s+=r+1;else s=1;return s}get_color_table_length(e,t){const s=7&e.readUInt8(t);return 3*Math.pow(2,s+1)}has_color_table(e,t){return!!(128&e.readUInt8(t))}get_version(e){return e.toString("ascii",3,6)}get_dimensions(e){let t=0,s=!1,r=0;for(r=this.has_color_table(e,10)?13+this.get_color_table_length(e,10):13;!s;){let n=e.readUInt8(r);44===n&&(t++,r+=9,this.has_color_table(e,r)&&(r+=this.get_color_table_length(e,r)),r+=2,r+=this.get_sub_block_length(e,r)),r+1>=e.length?s=!0:(n=e.readUInt8(r),33===n||44===n?r=this.next_chunk(e,r):s=!0)}return{width:e.readUInt16LE(6),height:e.readUInt16LE(8),frames:t}}is_truncated(e){return 59!==e.readUInt8(e.length-1)}get_pixel_format(){const e=new R;return e.color_space=$.RGB,e.indexed=!0,e.bit_depth.R=8,e.bit_depth.G=8,e.bit_depth.B=8,e.bit_depth.alpha=1,e}}var Q=s(816).Buffer;const ee=new Map;ee.set(65472,"SOF0"),ee.set(65473,"SOF1"),ee.set(65474,"SOF2"),ee.set(65475,"SOF3"),ee.set(65477,"SOF5"),ee.set(65478,"SOF6"),ee.set(65479,"SOF7"),ee.set(65480,"JPG"),ee.set(65481,"SOF9"),ee.set(65482,"SOF10"),ee.set(65483,"SOF11"),ee.set(65485,"SOF13"),ee.set(65486,"SOF14"),ee.set(65487,"SOF15"),ee.set(65476,"DHT"),ee.set(65484,"DAC"),ee.set(65488,"RST1"),ee.set(65489,"RST2"),ee.set(65490,"RST3"),ee.set(65491,"RST4"),ee.set(65492,"RST5"),ee.set(65493,"RST6"),ee.set(65494,"RST7"),ee.set(65495,"RST8"),ee.set(65496,"SOI"),ee.set(65497,"EOI"),ee.set(65498,"SOS"),ee.set(65499,"DQT"),ee.set(65500,"DNL"),ee.set(65501,"DRI"),ee.set(65502,"DHP"),ee.set(65503,"EXP");for(let e=0;e<=15;e++)ee.set(65504+e,"APP"+e);for(let e=0;e<=13;e++)ee.set(65520+e,"JPG "+e);ee.set(65534,"COM"),ee.set(65281,"TEM");for(let e=2;e<=191;e++)ee.set(65282+e,"RES");const te=65497;class se{describe(){return"UNK"}is_eoi_chunk(){return!1}is_sof_chunk(){return!1}static get_chunks(e,t){let s=!1;const r=[];for(;!s;){const n=e.readUInt16BE(t);let i;if(n>=65488&&n<=te)i=new ne(e,t),(t+=2)<e.length&&n>=65488&&n<=65495&&(r.push(i),i=ae.from_buffer(e,t),t+=i.length);else if(65498===n)i=new oe(e,t),t+=2+i.length,r.push(i),t<e.length&&(i=ae.from_buffer(e,t),t+=i.length);else{if(!ee.has(n))throw new Error(`Unknown marker code ${n.toString(16)} at offset ${t}`);i=new ie(e,t),t+=2+i.length}r.push(i),(t>=e.length-1||i.is_eoi_chunk())&&(s=!0)}return r}}class re{constructor(e,t){this.offset=t,this.marker_code=e.readUInt16BE(t)}describe(){return`${ee.get(this.marker_code)??"UNK"} (0x${this.marker_code.toString(16)}, offset ${this.offset})`}is_eoi_chunk(){return te===this.marker_code}is_sof_chunk(){const e=this.marker_code;return 192==(240&e)&&65476!==e&&65480!==e&&65484!==e}}class ne extends re{}class ie extends re{constructor(e,t){super(e,t),this.length=e.readUInt16BE(t+2),this.number_of_components=e.readUInt8(t+4)}}class oe extends re{constructor(e,t){super(e,t),this.scan_header_length=e.readUInt16BE(t+2),this.number_of_components=e.readUInt8(t+4),this.length=this.scan_header_length+6}}class ae extends se{constructor(e,t,s){super(),this.offset=t,this.length=s}describe(){return`Entropy Coded Segment (offset ${this.offset}, length ${this.length})`}static from_buffer(e,t){let s=!1;const r=t;let n=1e4;for(;!s&&n>0;){const r=e.indexOf(255,t+1);if(!(r>=0)){t=e.length;break}s=0!==e.readUInt8(r+1),t=r,n--}if(0===n)throw new Error("Maximum chunk size exceeded.");return new ae(e,r,t-r)}}class le extends L{get_overhead(){return 119}is_truncated(e){return e.readUInt16BE(e.length-2)!==te}get_dimensions(e){let t=null,s=null;const r=se.get_chunks(e,0);for(const n of r)if(n.is_sof_chunk()){t=e.readUInt16BE(n.offset+7),s=e.readUInt16BE(n.offset+5);break}if(!t||!s)throw new Error("Dimensions not found");return{width:t,height:s,frames:1}}get_pixel_format(e){const t=new R;let s=null;const r=se.get_chunks(e,0);for(const t of r)if(t.is_sof_chunk()){s=e.readUInt8(t.offset+9);break}return t.color_space=1===s?$.G:3===s?$.RGB:4===s?$.CMYK:$.unkownFormat("Unknown",s),t}}class ce extends Z{constructor(e){super(),this.buffer=e}lint(e){const t=se.get_chunks(this.buffer,0),s=t[t.length-1],r=s.length??2;s.offset+r<this.buffer.length&&e.error("This file contains extra data at the end of the file.")}}var he=s(816).Buffer;class de{constructor(e,t=0){this.buffer=e,this.offset=t,this.sub_bit=0,this.current_byte=e.readUInt8(t)}read_from_byte(e,t,s){let r=e,n=(1<<s)-1;return n=n<<t>>>0,r=(r&n)>>>t,r}read_bits(e){if(e>32)throw new Error(`Can not read more than 32 bits at a time. Attempting to read ${e}`);if(0===e)return 0;let t=0,s=0;const r=8-this.sub_bit;this.sub_bit>0&&e>r&&(e-=r,t=this.read_from_byte(this.current_byte,this.sub_bit,r),s=r,this.offset+=1,this.current_byte=this.buffer.readUInt8(this.offset),this.sub_bit=0);const n=Math.floor(e/8);let i=t;if(n>0){for(let e=0;e<n;e++){let e=this.read_from_byte(this.current_byte,0,8);s&&(e<<=s),this.offset+=1,this.current_byte=this.buffer.readUInt8(this.offset),s+=8,i|=e}this.sub_bit=0}if((e-=8*n)>0){let t=this.read_from_byte(this.current_byte,this.sub_bit,e);s&&(t<<=s),i|=t,this.sub_bit+=e}return i}read_boolean(){return!!this.read_bits(1)}get_bits_read(){return 8*this.offset+this.sub_bit}}const ue=4294967295;class _e extends Error{}class ge extends de{read_u32(...e){if(e.length>4)throw new Error("U32: A u32 takes only 4 distributions.");const t=e[this.read_bits(2)];if(0===t[0])return t[1];if(1===t[0])return this.read_bits(t[1]);if(2===t[0]){if(3!==t.length)throw new Error("U32: incorrect number of parameters for BitsOffset distribution.");return(t[2]+this.read_bits(t[1]))%ue}throw new Error("U32: Unknown distribution.")}read_s32(...e){const t=this.read_u32(...e);return t%2==0?t>>1:t===ue?2147483648:-(t>>1)}read_f16(){const e=this.read_bits(16),t=e>>15,s=e>>10&31,r=1023&e;let n;if(31===s)throw new _e("F16: Invalid biased exponent.");if(0==s)n=r/(1<<24);else{const e=s+112,i=r<<13,o=new ArrayBuffer(4);new Uint32Array(o)[0]=t<<31|e<<23|i,n=new Float32Array(o)[0]}return n}read_customxy(){return{x:this.read_s32([1,19],[2,19,524288],[2,20,1048576],[2,21,2097152]),y:this.read_s32([1,19],[2,19,524288],[2,20,1048576],[2,21,2097152])}}read_enum(e){const t=this.read_u32([0,0],[0,1],[2,4,2],[2,6,18]);if(t>63)throw new _e(`Enum: Invalid value: ${t}`);if(!e.has(t))throw new _e(`Enum: Unknown value: ${t}`);return t}}class me{constructor(e){let t,s;if(this.small=e.read_boolean(),t=this.small?8*(e.read_bits(5)+1):e.read_u32([1,9],[1,13],[1,18],[1,30])+1,this.ratio=e.read_bits(3),0===this.ratio)s=this.small?8*(e.read_bits(5)+1):e.read_u32([1,9],[1,13],[1,18],[1,30])+1;else if(1===this.ratio)s=t;else if(2===this.ratio)s=Math.floor(12*t/10);else if(3===this.ratio)s=Math.floor(4*t/3);else if(4===this.ratio)s=Math.floor(3*t/2);else if(5===this.ratio)s=Math.floor(16*t/9);else if(6===this.ratio)s=Math.floor(5*t/4);else{if(7!==this.ratio)throw new Error("SizeHeader: unknown aspect ratio.");s=Math.floor(2*t/1)}this.ysize=t,this.xsize=s}get_small(){return this.small}get_ysize(){return this.ysize}get_xsize(){return this.xsize}get_ratio(){return this.ratio}}const fe=new Set;fe.add(0),fe.add(1),fe.add(2),fe.add(3),fe.add(4);const pe=new Set;pe.add(1),pe.add(2),pe.add(10),pe.add(11);const we=new Set;we.add(1),we.add(2),we.add(9),we.add(11);const be=new Set;be.add(1),be.add(2),be.add(8),be.add(13),be.add(16),be.add(17),be.add(18);const xe=new Set;xe.add(0),xe.add(1),xe.add(2),xe.add(3);class ve{constructor(e){if(this.received_icc=!1,this.opaque_icc=!1,this.color_space=0,this.white_point=1,this.primaries=1,this.have_gamma=!1,this.gamma=0,this.transfer_function=13,this.rendering_intent=1,e){const t=e.read_boolean();t||(this.received_icc=e.read_boolean(),this.received_icc?this.opaque_icc=e.read_boolean():this.opaque_icc=!1,t||this.opaque_icc||(this.color_space=e.read_enum(fe),2!==this.color_space&&4!==this.color_space&&(this.white_point=e.read_enum(pe),2===this.white_point&&(this.white=e.read_customxy()),1!==this.color_space&&(this.primaries=e.read_enum(we),2===this.primaries&&(this.red=e.read_customxy(),this.green=e.read_customxy(),this.blue=e.read_customxy())),this.have_gamma=e.read_boolean(),this.have_gamma?this.gamma=e.read_bits(24):this.transfer_function=e.read_enum(be),1!==this.color_space&&(this.rendering_intent=e.read_enum(xe)))))}}}class ye{constructor(e){e.read_boolean()?(this.have_icc=!1,this.bits_per_sample=8,this.color_encoding=new ve,this.alpha_bits=0,this.target_nits=250,this.m2=null):(this.have_icc=e.read_boolean(),this.bits_per_sample=e.read_u32([0,8],[0,16],[0,32],[1,5]),this.color_encoding=new ve(e),this.alpha_bits=e.read_u32([0,0],[0,8],[0,16],[1,4]),this.target_nits=e.read_u32([0,5],[0,20],[0,80],[2,10,1]),this.m2=null)}}class ke extends L{get_overhead(){return 119}is_truncated(e){return 0!==e.readUInt8(e.length-1)}get_dimensions(e){const t=new ge(e,0),s=new me(t);return{width:s.get_xsize(),height:s.get_ysize(),frames:1}}get_pixel_format(e){const t=new ge(e,0),s=new ye(t).color_encoding,r=new R;return s&&(1===s.color_space?r.color_space=$.G:0===s.color_space?r.color_space=$.RGB:4===s.color_space?r.color_space=$.XYZ:2===s.color_space?r.color_space=$.XYB:r.color_space=$.unkownFormat(s)),r}}var Ue=s(816).Buffer;class Ie{constructor(e,t){this.length=e,this.tag=t}describe(e=""){return`${e} ${this.tag} (length ${this.length})\n`}static read(e,t){let s;const r=e.readUInt32BE(t);if(r){const n=e.toString("ascii",t+4,t+8),i=e.subarray(t+8,t+r);s=n in De?new De[n](r,n,i):new Be(r,n,i)}else s=new Se;return s}}class Ee extends Ie{constructor(e,t,s,r=0){super(e,t),this._buffer=s,this._offset=r,this._children=null}get children(){const e=this._buffer,t=this._offset;if(!this._children){this._children={};for(const s of this.readBlocks(e,t))null===s.tag||this._children[s.tag]||(this._children[s.tag]=s)}return this._children}*readBlocks(e,t){let s=0,r=2048;for(;s+t<e.length&&r;){const n=Ie.read(e,t+s);s+=n.length,r--,yield n}}describe(e=""){const t=super.describe(e),s=this.children;let r="";if(s)for(const t of Object.values(s))r+=t.describe(e+"    ");return t+r}}class Be extends Ie{constructor(e,t,s){super(e,t),this.content=s}}class Se extends Ie{constructor(){super(4,null)}}class Fe extends Ee{constructor(e){super(e.length,null,e)}}const De={ftyp:class extends Ie{constructor(e,t,s){super(e,t),this.majorBrand=this.readBrand(0,s),this.minorVersion=s.readUInt32BE(4),this.compatibleBrands=[];const r=(e-16)/4;for(let e=0;e<r;e++)this.compatibleBrands.push(this.readBrand(4*e+8,s))}readBrand(e,t){return t.subarray(e,e+4).toString("ascii")}},meta:Ee,iprp:Ee,iinf:class extends Ee{constructor(e,t,s){super(e,t,s,6)}},ipco:Ee,ispe:class extends Ie{constructor(e,t,s){super(e,t),this.unknown=s.readUInt32BE(0),this.width=s.readUInt32BE(4),this.height=s.readUInt32BE(8)}},pixi:class extends Ie{constructor(e,t,s){super(e,t,s),this.unknown=s.readUInt32BE(0),this.channels=s.readUInt8(4),this.bitsPerChannel=[];for(let e=0;e<this.channels;e++)this.bitsPerChannel.push(s.readUInt8(5))}}};class $e extends L{get_overhead(){return 333}is_truncated(e){return!1}get_dimensions(e){const t=new Fe(e).children.meta.children.iprp.children.ipco.children.ispe;return{width:t.width,height:t.height,frames:1}}get_pixel_format(e){const t=new Fe(e),s=new R;s.color_space=$.RGB;const r=t.children.meta.children.iprp.children.ipco.children.pixi;if(r){const e=r.channels;s.color_space=1===e?$.G:3===e?$.RGB:$.unkownFormat("Unknown",e)}else s.color_space=$.RGB;return s}}var Re=s(816).Buffer,ze=s(816).Buffer,Ce=s(816).Buffer;class Ne extends G{get_type_tag(){throw new Error("Not Implemented!")}can_validate(e){return e.length>12}is_of_file_type(e){const t=e.readUInt32BE(0),s=e.readUInt32BE(8);return 1380533830===t&&s===this.get_type_tag()}}const Ge=4;function Oe(e,t,s){const r=[];let n=t;for(;n<e.length;){const t=e.toString("ascii",n,n+Ge);let i;i="RIFF"===t?new Me(e,t,n,s):t in s?new s[t](e,t,n):new Le(e,t,n),r.push(i),n+=i.get_total_length()}return r}class Te{constructor(e,t,s){this.offset=s,this.header=t,this.length=e.readUInt32LE(s+Ge),this.data=e.subarray(s+Ge+4,s+Ge+4+this.length)}get_total_length(){const e=this.length%2;return Ge+4+this.length+e}describe(){return`${this.header} (offset: ${this.offset}, length: ${this.length})`}}class Le extends Te{}class Me extends Te{constructor(e,t,s,r){super(e,t,s),this.subchunk_id=this.data.toString("ascii",s,s+4),this.subchunks=Oe(e,s+Ge+4+4,r)}describe(){return super.describe()+`\n\nSubchunk Id: ${this.subchunk_id}\nNumber of subchunks: ${this.subchunks.length}\n`+this.subchunks.map((e=>e.describe())).join("\n")}}const Pe=["Bicubic, Normal Loop Filter","Bilinear, Simple Loop Filter","Bilinear, No Loop Filter","No Reconstruction Filter, No Loop Filter","Unknown"];function Ve(e,t){const s=e.readUInt8(t),r=e.readUInt8(t+1);return e.readUInt8(t+2)<<16|r<<8|s}const qe={"VP8 ":class extends Te{constructor(e,t,s){super(e,t,s);const r=new de(this.data,0);this.frame_type=r.read_boolean(),this.version=r.read_bits(3),this.show_frame=r.read_boolean(),this.data_partition_size=r.read_bits(19),this.is_valid=157===r.read_bits(8)&&1===r.read_bits(8)&&42===r.read_bits(8),this.width=r.read_bits(14),this.horz_scale=r.read_bits(2),this.height=r.read_bits(14),this.vert_scale=r.read_bits(2)}describe(){return super.describe()+"\n  Frame Type: "+(this.frame_type?"interframe":"keyframe")+"\n  Version: "+this.version+" ("+Pe[this.version]+")\n  Show Frame: "+this.show_frame+"\n  Valid: "+this.is_valid+"\n  Width: "+this.width+"\n  Height: "+this.height}},VP8L:class extends Te{constructor(e,t,s){super(e,t,s);const r=new de(this.data,0);this.is_valid=47===r.read_bits(8),this.width=r.read_bits(14)+1,this.height=r.read_bits(14)+1}describe(){return super.describe()+"\n  Width: "+this.width+"\n  Height: "+this.height}},VP8X:class extends Te{constructor(e,t,s){super(e,t,s),this.width=Ve(this.data,4)+1,this.height=Ve(this.data,7)+1}describe(){return super.describe()+"\n  Width: "+this.width+"\n  Height: "+this.height}},ANIM:Le,ANMF:Le};function Ae(e,t){return Oe(e,t,qe)}class Ye extends L{get_overhead(){return 333}is_truncated(e){return!1}get_dimensions(e){const t=Ae(e,0)[0];let s;return t instanceof Me&&(s=t.subchunks.find((e=>"VP8X"===e.header||"VP8L"===e.header))),{width:s.width,height:s.height,frames:1}}get_pixel_format(e){const t=new R;return t.color_space=$.RGB,t}}class We extends G{get_root_element(){throw new Error("Not Implemented!")}is_of_file_type(e){return e.slice(0,512).toString().toLowerCase().includes("<"+this.get_root_element())}can_validate(e){return!0}}class je{static register(e){const t=new e,s=t.identify_only();for(const e of t.get_extensions())this._extension_registry.set(e,t),s||this._all_extensions.push(e);for(const e of t.get_mimes())this._mime_registry.set(e,t),s||this._all_mimes.push(e);this._all_providers.push(t)}static clear_registry(){this._extension_registry.clear(),this._all_extensions.length=0,this._mime_registry.clear(),this._all_mimes.length=0,this._all_providers.length=0}static get_all_extensions(){return je._all_extensions}static get_all_mimes(){return je._all_mimes}static from_extension(e){return je._extension_registry.get(e)}static from_file_descriptor(e){return je.from_extension(e.extension)}static*all_providers(){yield*je._all_providers}}je._extension_registry=new Map,je._mime_registry=new Map,je._all_providers=[],je._all_extensions=[],je._all_mimes=[],je.register(class extends T{get_magic(){return X.from("89504e470d0a1a0a","hex")}get_extensions(){return[".png"]}get_mimes(){return["image/png"]}get_info_provider(){return H}get_linter(e){return new K(e)}debug_print(e,t){const s=q.get_chunks(e,8);t.write(`Number of chunks: ${s.length}\n`);for(const e of s)t.write(e.describe()),t.write("\n")}}),je.register(class extends T{get_magic(){return Q.from("GIF")}get_extensions(){return[".gif"]}get_mimes(){return["image/gif"]}get_info_provider(){return J}}),je.register(class extends T{get_magic(){return he.from("ffd8ff","hex")}get_extensions(){return[".jpg",".jpeg",".jpe"]}get_mimes(){return["image/jpeg"]}get_info_provider(){return le}get_linter(e){return new ce(e)}debug_print(e,t){const s=se.get_chunks(e,0);t.write(`Number of chunks: ${s.length}\n`);for(const e of s)t.write(e.describe()),t.write("\n")}}),je.register(class extends T{get_magic(){return Ue.from("ff0a","hex")}get_extensions(){return[".jxl"]}get_mimes(){return["image/jxl"]}get_info_provider(){return ke}}),je.register(class extends G{can_validate(e){return e.length>12}is_of_file_type(e){const t=e.subarray(4,12).toString("ascii");return"ftypavif"===t||"ftypheic"===t}get_extensions(){return[".avif",".heif",".heic"]}get_mimes(){return["image/avif","image/heif","image/heic"]}get_info_provider(){return $e}debug_print(e,t){const s=new Fe(e);t.write(s.describe())}}),je.register(class extends T{get_magic(){return Re.from("424D","hex")}get_extensions(){return[".bmp"]}get_mimes(){return["image/bmp","image/x-bmp"]}}),je.register(class extends T{get_magic(){return ze.from("38425053","hex")}get_extensions(){return[".psd"]}get_mimes(){return["image/photoshop","image/x-photoshop","image/psd"]}}),je.register(class extends G{can_validate(e){return e.length>4}is_of_file_type(e){const t=e.readUInt16LE(0),s=e.readUInt16LE(2);return 0===t&&(1===s||2===s)}get_extensions(){return[".ico",".cur"]}get_mimes(){return["image/x-icon"]}}),je.register(class extends T{get_magic(){return Ce.from([73,73,42,0])}get_extensions(){return[".tif",".tiff"]}get_mimes(){return["image/tiff","image/tiff-fx"]}}),je.register(class extends Ne{get_type_tag(){return 1464156752}get_extensions(){return[".webp"]}get_mimes(){return["image/webp"]}get_info_provider(){return Ye}debug_print(e,t){const s=Ae(e,0);t.write(`Number of chunks: ${s.length}\n`);for(const e of s)t.write(e.describe()),t.write("\n")}}),je.register(class extends We{get_root_element(){return"svg"}get_extensions(){return[".svg"]}get_mimes(){return["image/svg+xml"]}}),je.register(class extends We{get_root_element(){return"html"}get_extensions(){return[".html",".htm",".xhtml"]}get_mimes(){return["text/html","application/xhtml+xml"]}});var He=s(816).Buffer;class Ze extends Error{}class Ke extends B.EventEmitter{constructor(e){super(),this.finder=e,this.disable_color=!1}calculate_optimial_size(e,t){return e.width*e.height*e.frames*t}describe_file(e){return"File properties: "+e.width+"x"+e.height+(1!==e.frames?", "+e.frames+" frames":"")}get_identifier(e,t,s,r){return new Promise(((n,i)=>{const o=e.extension.toLowerCase();let a=je.from_extension(o),l=null,c=!1;if(t instanceof He){if(l=t,a?c=a.is_of_file_type(l):s.warn('There is no information provider for "'+o+'" files.'),!a||!c){!0===r.mismatch?s.info("This file is not what it seems, attempting brute force discovery of file type."):s.info("This file is not what it seems."),a=null;for(const e of je.all_providers())e.can_validate(l)&&e.is_of_file_type(l)&&(a=e)}if(!c){let e="unknown";a&&(e=a.get_extension()),!0===r.mismatch&&s.warn("There is a mismatch between the file extension ("+o+") and the file contents ("+e+")")}a?n(a):i(new Ze("Unknown file type"))}else i(new Ze("Image buffer is missing, this is a bug."))}))}get_info(e,t){const s=e.get_info_provider();let r;if(!s)throw new Ze("Unsupported file type");return r=(new s).get_info(t),r}lint(e,t){const s=new S,r=new D;let n=null;if(t.color_space){const e=t.color_space;n=new Set;for(let t of e)t=$.from(t),t&&n.add(t)}return s.on("next",(async(e,i)=>{const o=N.get_logger(e.path);try{const a=await e.loader.load();if(s.is_stopped())return void i();if(0===a.length)throw new Ze("This is an empty file, further analysis is not possible.");if(!0===t.duplicate){const t=r.contains(e.path,a);t&&o.warn("This file is a duplicate of: "+t)}const l=await this.get_identifier(e,a,o,t),c=await this.get_info(l,a);if(s.is_stopped())return void i();if(c.truncated)o.error("This image is truncated, further analysis is not possible.");else{const e=c.pixel_format.color_space,s=t.bytes_per_pixel,r=t.byte_savings,i=c.size-this.calculate_optimial_size(c.dimensions,s);if(o.info(this.describe_file(c.dimensions)),c.bytes_per_pixel>=s&&i>r&&(o.warn("The bytes per pixel ("+c.bytes_per_pixel.toFixed(2)+") exceeds the minimum ("+s+")."),o.info("You can acheive a minimum savings of "+i+" bytes by meeting this threshold.")),n)if("UNK"===e.name){const t=e.channels>0?e.channels:"an unknown number of";o.error(`This image has an unknown color space ${e.getUnkFormat()} with ${t} channels.`)}else n.size&&!n.has(e)&&o.warn(`The color space of this image is ${e.name}. It must be one of ${t.color_space}.`);const h=l.get_linter(a);h&&h.lint(o)}}catch(e){e instanceof Ze?o.error(e.message):e.stack?o.error(e.message+": "+e.stack):o.error(e)}finally{t.max_warnings>=0&&N.get_warning_count()>t.max_warnings&&(s.is_stopped()||(o.error(`Too many warnings. A maximum of ${t.max_warnings} warnings are allowed.`),s.stop())),this.emit("file.completed",o),i()}})),s.on("end",(()=>{this.emit("linter.completed")})),s.start(this.finder.get_files(e)),this}}const Xe={bytes_per_pixel:3,byte_savings:500,color_space:"G,RGB",mismatch:!0,duplicate:!0,max_warnings:-1};class Je{constructor(e,t){this.extensions=e,this.mimes=t}get_files(e){throw new Error("Not Implemented")}is_image_extension(e){return this.extensions.indexOf(e)>=0}is_image_mime(e){return this.mimes.indexOf(e)>=0}}class Qe{constructor(e){this._path=e}getPath(){return this._path}load(){return Promise.reject(new Error("Not Implemented!"))}}var et=s(816).Buffer;class tt extends Qe{constructor(e){super(""),this._blob=e}async load(){const e=await this._blob.arrayBuffer();return et.from(e)}}var st=s(7425);const rt={components:{},data(){const e=Object.assign({},Xe);return e.color_space=e.color_space.split(","),{support:{},available:{color_space:["G","RGB","CMYK","YCbCr","YCCK","LAB","HSV"]},option:e,files:[]}},methods:{clear:function(){this.files.length=0}}},nt=(0,m.Z)(rt,[["render",function(e,t,s,n,i,l){const c=(0,o.up)("vue-multiselect"),h=(0,o.up)("iml-image-collection"),d=(0,o.up)("iml-dropzone");return(0,o.wg)(),(0,o.iD)("form",p,[(0,o._)("div",w,[b,(0,o._)("label",x,[(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>i.option.mismatch=e),type:"checkbox"},null,512),[[r.e8,i.option.mismatch]]),(0,o.Uk)(" Find mismatches between file type and file extension. ")]),(0,o._)("label",v,[(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>i.option.duplicate=e),type:"checkbox"},null,512),[[r.e8,i.option.duplicate]]),(0,o.Uk)(" Find files that have been copied. ")]),(0,o._)("label",y,[(0,o.Uk)(" Set the maximum bytes per pixel before giving a warning. "),(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>i.option.bytes_per_pixel=e),type:"number",step:"0.1",min:"0"},null,512),[[r.nr,i.option.bytes_per_pixel]])]),(0,o._)("label",k,[(0,o.Uk)(" Set the minimum byte savings before giving a warning. "),(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>i.option.byte_savings=e),type:"number",min:"0"},null,512),[[r.nr,i.option.byte_savings]])]),(0,o._)("label",U,[(0,o.Uk)(" Set the allowed color spaces. "),(0,o.Wm)(c,{modelValue:i.option.color_space,"onUpdate:modelValue":t[4]||(t[4]=e=>i.option.color_space=e),multiple:!0,options:i.available.color_space},null,8,["modelValue","options"])])]),(0,o._)("div",I,[(0,o.Wm)(d,{modelValue:i.files,"onUpdate:modelValue":t[6]||(t[6]=e=>i.files=e),class:(0,a.C_)({empty:0==i.files.length})},{default:(0,o.w5)((()=>[i.files.length?((0,o.wg)(),(0,o.iD)("div",E,[(0,o._)("button",{type:"button",onClick:t[5]||(t[5]=(...t)=>e.clear&&e.clear(...t))}," Clear Results "),(0,o.Wm)(h,{options:i.option,files:i.files},null,8,["options","files"])])):(0,o.kq)("",!0)])),_:1},8,["modelValue","class"])])])}]]),it={class:"docs-page"},ot=[(0,o.uE)('<nav class="toc"><ol class="toc-level toc-level-1"><li class="toc-item toc-item-h1"><a class="toc-link toc-link-h1" href="#docs">Docs</a></li></ol></nav><h1 id="docs">Docs</h1><p>This is the docs for image-lint.</p>',3)],at={},lt=(0,m.Z)(at,[["render",function(e,t){return(0,o.wg)(),(0,o.iD)("div",it,ot)}]]),ct={class:"docs-page"},ht=[(0,o.uE)('<nav class="toc"><ol class="toc-level toc-level-1"><li class="toc-item toc-item-h1"><a class="toc-link toc-link-h1" href="#getting-started">Getting Started</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#prerequisites">Prerequisites</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#running-image-lint">Running image-lint</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#installing-image-lint-globally">Installing image-lint globally</a></li></ol></li></ol></nav><h1 id="getting-started">Getting Started</h1><p>image-lint is an application for finding issues with images. Its main focus is helping to reduce bandwidth utilization and detecting broken images in web applications.</p><h2 id="prerequisites">Prerequisites</h2><p>To use image-lint you must first install <a href="https://nodejs.org/">Node.js</a> &gt;=16.0.0.</p><h2 id="running-image-lint">Running image-lint</h2><p>You can run image-lint without installing it using <code>npx</code>.</p><pre style="background:#2e3440;"><code class="language-sh"><span style="color:#D8DEE9FF;">npx image-lint images/</span>\n</code></pre><h2 id="installing-image-lint-globally">Installing image-lint globally</h2><p>If you use image-lint a lot, it can be install using npm.</p><pre style="background:#2e3440;"><code class="language-sh"><span style="color:#D8DEE9FF;">npm install -g image-lint</span>\n</code></pre><p>And then you can run it against your images directory:</p><pre style="background:#2e3440;"><code class="language-sh"><span style="color:#D8DEE9FF;">image-lint images/</span>\n</code></pre>',13)],dt={},ut=(0,m.Z)(dt,[["render",function(e,t){return(0,o.wg)(),(0,o.iD)("div",ct,ht)}]]),_t={class:"lint-results"},gt={open:""},mt={key:0},ft={key:0},pt={key:0},wt={key:1},bt={key:0},xt={key:2},vt=["innerHTML"],yt=new class extends Je{get_files(e){return Promise.resolve(this._search.bind(this,e))}*_search(e){for(const t of e){const e=st.extname(t.name);yield{path:t.name,extension:e,loader:new tt(t)}}}}(je.get_all_extensions(),je.get_all_mimes()),kt={props:{options:{type:Object,required:!0},files:{type:Array,required:!0}},data:()=>({linter:null,error:null,results:null}),computed:{has_finished(){return null!==this.results||null!==this.error},has_error(){return null!==this.error},has_results(){return null!==this.results}},watch:{files:{async handler(e,t){const s=this.options,r=new Ke(yt);let n=null;try{n=await new Promise(((t,n)=>{const i=[];r.lint(e,s).on("file.completed",(e=>{i.push(e)})).on("linter.completed",(()=>{t(i)}))}))}catch(e){return void(this.error=e)}this.results=n},immediate:!0}},methods:{reformat_log:e=>e.trim().split("\n").map((e=>e.trim())).join("\n")}},Ut=(0,m.Z)(kt,[["render",function(e,t,s,r,n,i){return(0,o.wg)(),(0,o.iD)("ul",_t,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.results,(t=>((0,o.wg)(),(0,o.iD)("li",{key:t.filename,class:(0,a.C_)(["lint-result",{"has-error":e.has_error,"has-results":e.has_results}])},[(0,o._)("details",gt,[(0,o._)("summary",{class:(0,a.C_)(["lint-result-summary",{"lint-error":t&&t.count.error,"lint-warn":t&&t.count.warn}])},[(0,o.Uk)((0,a.zw)(t.filename)+" ",1),e.has_results?((0,o.wg)(),(0,o.iD)("span",mt,[(0,o.Uk)(" - "),t.count.info?((0,o.wg)(),(0,o.iD)("span",ft,[(0,o.Uk)(" Info: "+(0,a.zw)(t.count.info),1),t.count.warn||t.count.error?((0,o.wg)(),(0,o.iD)("span",pt,", ")):(0,o.kq)("",!0)])):(0,o.kq)("",!0),t.count.warn?((0,o.wg)(),(0,o.iD)("span",wt,[(0,o.Uk)(" Warnings: "+(0,a.zw)(t.count.warn),1),t.count.error?((0,o.wg)(),(0,o.iD)("span",bt,", ")):(0,o.kq)("",!0)])):(0,o.kq)("",!0),t.count.error?((0,o.wg)(),(0,o.iD)("span",xt,"Errors: "+(0,a.zw)(t.count.error),1)):(0,o.kq)("",!0)])):(0,o.kq)("",!0)],2),e.has_results?((0,o.wg)(),(0,o.iD)("output",{key:0,class:"lint-result-output",innerHTML:e.reformat_log(t.log)},null,8,vt)):(0,o.kq)("",!0)])],2)))),128))])}]]),It={props:{modelValue:{type:Array,required:!0}},emits:["update:modelValue"],methods:{files:function*(e){if(e.items)for(const t of e.items)yield t.getAsFile();else yield*e.files},drop:function(e){e.preventDefault(),this.$refs.dropzone.classList.remove("active");const t=Array.from(this.files(e.dataTransfer));this.$emit("update:modelValue",t)},dragenter:function(){this.$refs.dropzone.classList.add("active")},dragleave:function(){this.$refs.dropzone.classList.remove("active")},dragover:function(e){e.preventDefault()}}},Et=(0,m.Z)(It,[["render",function(e,t,s,r,n,i){return(0,o.wg)(),(0,o.iD)("div",{ref:"dropzone",class:"drop-target",onDrop:t[0]||(t[0]=(...t)=>e.drop&&e.drop(...t)),onDragover:t[1]||(t[1]=(...t)=>e.dragover&&e.dragover(...t)),onDragenter:t[2]||(t[2]=(...t)=>e.dragenter&&e.dragenter(...t)),onDragleave:t[3]||(t[3]=(...t)=>e.dragleave&&e.dragleave(...t))},[(0,o.WI)(e.$slots,"default",{},(()=>[(0,o.Uk)("Drop files here")]))],544)}]]),Bt=document.body,St=document.createElement("div");Bt.appendChild(St);const Ft=(0,i.p7)({history:(0,i.PO)("/image-lint/"),routes:[{path:"/",component:nt},{path:"/docs",component:lt},{path:"/getting-started",component:ut}]});(0,r.ri)(f).component("vue-multiselect",n.ZP).component("iml-image-collection",Ut).component("iml-dropzone",Et).use(Ft).mount(St)}},e=>{e.O(0,[216],(()=>(4987,e(e.s=4987)))),e.O()}]);
//# sourceMappingURL=main.0bdccad5de761765a225.js.map